{
	# Global options
	admin off
}

{$DOMAIN:localhost} {
	# Serve static files from Hugo build
	root * /srv
	file_server

	# Proxy API requests to Go backend
	handle /api/* {
		reverse_proxy localhost:8080
	}

	# Handle SPA-style routing - try files first, then index
	try_files {path} {path}/ /index.html

	# Security headers
	header {
		X-Content-Type-Options nosniff
		X-Frame-Options DENY
		Referrer-Policy strict-origin-when-cross-origin
	}

	# Compression
	encode gzip zstd

	# Logging
	log {
		output stdout
		format console
	}
}
